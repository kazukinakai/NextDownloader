# NextDownloader タスク管理

## 現在の主タスク（2025年5月17日）

- [x] プロジェクト構造の設計と初期設定
- [x] 必要なドキュメントの作成（PLANNING.md, TASK.md, KNOWLEDGE.md）
- [ ] Chrome拡張機能の基本実装
  - [ ] メディア検出機能の実装
  - [ ] ポップアップUIの設計と実装
  - [ ] バックグラウンドスクリプトの実装
  - [ ] Native Messaging APIの実装
- [ ] Macアプリの基本実装
  - [ ] SwiftUIベースのUIフレームワーク構築
  - [ ] ダウンロード管理機能の実装
  - [ ] 外部ツール（yt-dlp, aria2c, ffmpeg）の統合
  - [ ] 設定画面の実装
- [ ] Rustコアの初期設計
  - [ ] プロジェクト構造の設計
  - [ ] 基本的なインターフェースの定義
  - [ ] Swift/SwiftUIとの連携方法の検討

## 優先度の高いタスク

1. **Chrome拡張機能の開発**
   - HLS/DASH動画の検出ロジックの実装
   - Native Messaging APIを使用したMacアプリとの通信確立

2. **Macアプリの基本機能実装**
   - ダウンロードキュー管理システムの構築
   - 外部ツール（yt-dlp, aria2c, ffmpeg）のラッパー実装

3. **Rustコアの設計と初期実装**
   - クロスプラットフォーム対応を見据えた設計
   - 基本的なダウンロードエンジンの実装

## 作業中に発見されたタスク

- [ ] 外部ツールのバージョン管理と自動更新機能の検討
- [ ] DRM保護コンテンツへの対応方法の詳細設計
- [ ] エラーハンドリングとリトライ機構の設計
- [ ] ユーザー設定の永続化機能の実装方法

## 完了したタスク

- [x] プロジェクト構造の初期設計（2025年5月17日）
- [x] 必要なドキュメントの作成（2025年5月17日）

## 将来の課題

- [ ] Windows/Linux対応のためのクロスプラットフォーム設計
- [ ] 高度なメディア変換機能の追加
- [ ] クラウドサービスとの連携機能
- [ ] バッチ処理とスケジュール機能
- [ ] プラグイン機構の設計と実装

## 進行中のタスクの詳細

### Chrome拡張機能の開発

Chrome拡張機能は以下の主要コンポーネントで構成されます：

1. **コンテンツスクリプト**
   - Webページ内のメディア要素を検出
   - HLS/DASH形式のURLを抽出
   - メディアメタデータ（タイトル、サムネイル等）の収集

2. **バックグラウンドスクリプト**
   - Native Messaging APIを使用したMacアプリとの通信
   - ブラウザセッション情報の管理
   - 拡張機能の状態管理

3. **ポップアップUI**
   - 検出されたメディアの表示
   - ダウンロードオプションの提供
   - 設定インターフェース

### Macアプリの開発

Macアプリは以下の主要機能を実装する必要があります：

1. **ダウンロード管理**
   - ダウンロードキューの管理
   - 進捗状況の表示
   - 一時停止/再開/キャンセル機能

2. **外部ツール連携**
   - yt-dlp: メディア情報の抽出
   - aria2c: 並列ダウンロード処理
   - ffmpeg: メディアの処理と結合

3. **設定管理**
   - ダウンロード設定（保存先、並列数等）
   - 外部ツール設定
   - UI設定

### Rustコアの開発

Rustコアは以下の機能を提供する必要があります：

1. **ダウンロードエンジン**
   - HLS/DASH解析
   - 並列ダウンロード制御
   - エラーハンドリングとリトライ

2. **外部ツール連携**
   - 各ツールのラッパー実装
   - プロセス管理
   - 出力解析

3. **クロスプラットフォームインターフェース**
   - FFI（Foreign Function Interface）
   - プラットフォーム固有の最適化
